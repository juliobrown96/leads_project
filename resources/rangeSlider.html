
<div class="main">
  <input
      type="range"
      name="rangeenvio"
      min="5"
      max="51"
      value="20"
  >
  <span class="rangeslider__tooltip" id ="range-tooltip"></span>
</div>

<script>

    const $element = $('input[name="limite_envio"]');
    const $tooltip = $('#range-tooltip');
    const $rangeEnvio = $('input[name="limite_envio"]');
    const sliderStates = [
      {name: "low", tooltip: "Você tem uma equipe pequena algo entre<strong>1 e 3 captadores</strong>.", range: _.range(5, 26) },
      {name: "med", tooltip: "Você tem uma equipe completa de <strong>3 a 5 captadores</strong>.", range: _.range(26, 51)},
      {name: "high", tooltip: "Você deseja receber o maximo possivel no dia, <strong>você tem uma grande equipe de vendas</strong>.", range: [51] },
    ];
    var currentState;
    var $handle;

    $element
      .rangeslider({
        polyfill: false,
        onInit: function() {
          $handle = $('.rangeslider__handle', this.$range);
          const initialRangeValue = $rangeEnvio.val();
          updateHandle($handle[0], initialRangeValue);
          updateState($handle[0], initialRangeValue);
        }
      })
      .on('input', function() {
        updateHandle($handle[0], this.value);
        checkState($handle[0], this.value);
      });

    // Update the value inside the slider handle and the hidden input
    function updateHandle(el, val) {
      el.textContent = val;
      $rangeEnvio.val(val);
    }

    // Check if the slider state has changed
    function checkState(el, val) {
      if (!_.contains(currentState.range, parseInt(val))) {
        updateState(el, val);
      }
    }

    // Change the state of the slider
    function updateState(el, val) {
      for (var j = 0; j < sliderStates.length; j++){
        if (_.contains(sliderStates[j].range, parseInt(val))) {
          currentState = sliderStates[j];
        }
      }
      if (currentState.name == "high") {
        updateHandle($handle[0], "50+");
      }
      $handle
        .removeClass(function (index, css) {
          return (css.match(/(^|\s)js-\S+/g) || []).join(' ');
        })
        .addClass("js-" + currentState.name);
      $tooltip.html(currentState.tooltip);
    }

</script>
